<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏∞‡πÄ‡∏¢‡∏≤</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #E3F2FD 0%, #FFFFFF 100%);
            color: #1F2937;
        }

        .main-wrapper {
            height: 100%;
            width: 100%;
            overflow-y: auto;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #0D47A1 0%, #1976D2 100%);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(13, 71, 161, 0.3);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 40px;
            flex-wrap: wrap;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .header-text h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .header-text p {
            font-size: 16px;
            opacity: 0.9;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 18px;
        }
        
        .user-info-badge {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 10px 20px;
            text-align: right;
        }
        
        .user-info-badge div {
            line-height: 1.5;
        }
        
        #user-display-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        #user-role {
            font-size: 13px;
            opacity: 0.9;
        }
        
        .logout-btn {
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 12px 24px;
            font-family: 'Sarabun', sans-serif;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(220, 38, 38, 0.2);
        }
        
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(220, 38, 38, 0.4);
        }

        .nav-menu {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            background: white;
            border: 2px solid #1976D2;
            color: #1976D2;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(25, 118, 210, 0.1);
            font-family: 'Sarabun', sans-serif;
        }

        .nav-btn:hover {
            background: #1976D2;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(25, 118, 210, 0.3);
        }

        .nav-btn.active {
            background: #1976D2;
            color: white;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 24px rgba(25, 118, 210, 0.08);
            border: 1px solid rgba(25, 118, 210, 0.1);
        }

        .card h2 {
            color: #0D47A1;
            font-size: 26px;
            font-weight: 700;
            border-bottom: 3px solid #E3F2FD;
            padding-bottom: 14px;
            margin: 0 0 28px 0;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #1F2937;
            font-size: 15px;
        }

        .required {
            color: #DC2626;
            font-weight: 700;
        }

        input, select, textarea {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Sarabun', sans-serif;
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #FFFFFF 0%, #F8FAFC 100%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            min-height: 52px;
        }

        input[type="date"],
        input[type="time"] {
            cursor: pointer;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #1976D2;
            box-shadow: 0 0 0 4px rgba(25, 118, 210, 0.12), 0 4px 16px rgba(25, 118, 210, 0.08);
            background: #FFFFFF;
            transform: translateY(-1px);
        }

        input:hover, select:hover, textarea:hover {
            border-color: #64B5F6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        .btn-primary {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-family: 'Sarabun', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.2);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #1565C0 0%, #0D47A1 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(25, 118, 210, 0.35);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .equipment-section {
            border: 2px solid #E3F2FD;
            border-radius: 16px;
            padding: 28px;
            margin-top: 20px;
            background: linear-gradient(145deg, #F8FAFC 0%, #F1F5F9 100%);
            box-shadow: 0 4px 16px rgba(25, 118, 210, 0.06);
        }

        .equipment-category {
            margin-bottom: 28px;
        }

        .equipment-category h4 {
            color: #0D47A1;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
            padding: 12px 16px;
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            border-radius: 10px;
            border-left: 4px solid #1976D2;
        }

        .equipment-item {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 14px;
            padding: 16px 20px;
            background: linear-gradient(145deg, #FFFFFF 0%, #F8FAFC 100%);
            border-radius: 12px;
            border: 1px solid #E5E7EB;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
        }

        .equipment-item:hover {
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.08);
            transform: translateY(-1px);
        }

        .equipment-item input[type="checkbox"] {
            width: auto;
            min-width: 20px;
            min-height: 20px;
            transform: scale(1.2);
            accent-color: #1976D2;
            cursor: pointer;
        }

        .equipment-item label {
            margin: 0;
            flex: 1;
            font-size: 15px;
            cursor: pointer;
        }

        .equipment-item input[type="number"],
        .equipment-item input[type="text"] {
            width: 120px;
            margin-left: auto;
            padding: 10px 14px;
            font-size: 14px;
            min-height: auto;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 16px;
            background: #F8FAFC;
            border-radius: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .calendar-controls button {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-family: 'Sarabun', sans-serif;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(25, 118, 210, 0.2);
        }

        .calendar-controls button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(25, 118, 210, 0.35);
        }

        .calendar-month {
            font-size: 22px;
            font-weight: 700;
            color: #0D47A1;
        }

        .calendar-header-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            margin-bottom: 1px;
            overflow: hidden;
            border-radius: 10px 10px 0 0;
        }

        .calendar-header-days div {
            background: #1976D2;
            color: white;
            text-align: center;
            padding: 12px;
            font-weight: 600;
            font-size: 15px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #E5E7EB;
            border-radius: 10px;
            overflow: hidden;
        }

        .calendar-day {
            background: white;
            min-height: 180px;
            padding: 8px;
            position: relative;
            overflow-y: auto;
        }

        .calendar-day-number {
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .calendar-day-header {
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .calendar-day.other-month {
            background: #F9FAFB;
            opacity: 0.5;
        }

        .calendar-day.today {
            background: #E3F2FD;
            border: 2px solid #1976D2;
        }

        .calendar-event {
            background: #7C3AED;
            color: white;
            padding: 8px 10px;
            border-radius: 8px;
            font-size: 11px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            border-left: 4px solid rgba(255, 255, 255, 0.3);
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .calendar-event:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        }

        .room-‡∏®ÔøΩÔøΩ‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© { 
            background: #7C3AED; 
        }
        
        .room-‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏©:hover { 
            background: #6D28D9; 
        }

        .room-‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á { 
            background: #F97316; 
        }
        
        .room-‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á:hover { 
            background: #EA580C; 
        }

        .room-‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ { 
            background: #10B981; 
        }
        
        .room-‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ:hover { 
            background: #059669; 
        }

        .room-ha { 
            background: #EF4444; 
        }
        
        .room-ha:hover { 
            background: #DC2626; 
        }

        .room-‡∏û‡∏±‡∏™‡∏î‡∏∏ { 
            background: #EC4899; 
        }
        
        .room-‡∏û‡∏±‡∏™‡∏î‡∏∏:hover { 
            background: #DB2777; 
        }

        .room-‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• { 
            background: #06B6D4; 
        }
        
        .room-‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•:hover { 
            background: #0891B2; 
        }

        .status-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .status-item {
            background: white;
            border-left: 5px solid #1976D2;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .status-item:hover {
            transform: translateX(6px);
            box-shadow: 0 4px 20px rgba(25, 118, 210, 0.18);
        }

        .status-item h4 {
            color: #0D47A1;
            margin-bottom: 12px;
            font-size: 18px;
        }

        .status-item p {
            margin: 8px 0;
            color: #374151;
            line-height: 1.6;
        }

        .admin-bookings-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .chart-btn {
            background: white;
            border: 2px solid #1976D2;
            color: #1976D2;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Sarabun', sans-serif;
        }

        .chart-btn:hover {
            background: #1976D2;
            color: white;
        }

        .chart-btn.active {
            background: #1976D2;
            color: white;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 14px;
        }

        .status-badge {
            padding: 8px 18px;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 12px;
        }

        .status-pending { 
            background: #FEF3C7; 
            color: #92400E; 
        }
        
        .status-head { 
            background: #DBEAFE; 
            color: #1E40AF; 
        }
        
        .status-supervisor { 
            background: #DBEAFE; 
            color: #1E40AF; 
        }
        
        .status-approved { 
            background: #D1FAE5; 
            color: #065F46; 
        }
        
        .status-rejected { 
            background: #FEE2E2; 
            color: #991B1B; 
        }

        .status-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            color: #6B7280;
            font-size: 14px;
        }

        #dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 4px 16px rgba(25, 118, 210, 0.25);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 10px 28px rgba(25, 118, 210, 0.35);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 16px;
            opacity: 0.95;
            font-weight: 500;
        }

        .chart-controls {
            display: flex;
            gap: 14px;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .chart-controls label {
            font-weight: 600;
            color: #374151;
            font-size: 15px;
        }

        .chart-controls select {
            padding: 10px 18px;
            border: 2px solid #1976D2;
            border-radius: 25px;
            font-family: 'Sarabun', sans-serif;
            font-size: 15px;
            background: white;
            color: #1976D2;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            min-height: auto;
        }

        .chart-controls select:hover {
            background: #1976D2;
            color: white;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 28px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
        }

        .admin-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .btn-small {
            padding: 8px 18px;
            border: none;
            border-radius: 10px;
            font-family: 'Sarabun', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-info {
            background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            color: white;
        }

        .btn-small:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
        }

        .user-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .user-table th {
            background: #E3F2FD;
            color: #0D47A1;
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 15px;
            border-bottom: 2px solid #1976D2;
        }

        .user-table td {
            padding: 14px 16px;
            border-bottom: 1px solid #E5E7EB;
            font-size: 14px;
        }

        .user-table tr:hover {
            background: #F8FAFC;
        }

        #auth-gate-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0D47A1 0%, #1976D2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            overflow-y: auto;
            padding: 20px 0;
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 42px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            margin: auto;
            max-height: 95vh;
            overflow-y: auto;
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 28px;
        }

        .auth-logo img {
            width: 80px;
            height: 80px;
            margin-bottom: 14px;
            object-fit: contain;
        }

        .auth-logo h2 {
            color: #0D47A1;
            font-size: 24px;
            font-weight: 700;
            margin: 0;
        }

        .auth-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 2px solid #E5E7EB;
        }

        .auth-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: #6B7280;
            font-family: 'Sarabun', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-tab.active {
            color: #1976D2;
            border-bottom-color: #1976D2;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-message {
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        #auth-error-message {
            background: #FEE2E2;
            color: #991B1B;
            border-left: 4px solid #DC2626;
        }

        #auth-success-message {
            background: #D1FAE5;
            color: #065F46;
            border-left: 4px solid #10B981;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 14px 22px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 10000;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            animation: slideInFromRight 0.3s ease-out;
            font-size: 14px;
        }

        @keyframes slideInFromRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.success {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
        }

        .toast.error {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
        }

        .hidden {
            display: none;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 0;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            border-bottom: 2px solid #E3F2FD;
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .page.hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                justify-content: center;
                text-align: center;
                padding: 0 20px;
            }
            
            .calendar-day {
                min-height: 120px;
                font-size: 12px;
            }

            #dashboard-stats {
                grid-template-columns: 1fr;
            }

            .header-left {
                flex-direction: column;
                align-items: center;
            }

            .header-right {
                justify-content: center;
                width: 100%;
            }
            
            .user-info-badge {
                text-align: center;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div class="main-wrapper">
   <div id="auth-gate-overlay">
    <div class="auth-card">
     <div class="auth-logo"><img src="https://upload.wikimedia.org/wikipedia/th/d/d7/MED_Phayao.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏∞‡πÄ‡∏¢‡∏≤" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
      <div style="display:none; font-size:14px; color:#6B7280;">
       ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
      </div>
      <h2 style="line-height: 1.4;">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°<br>
       ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏∞‡πÄ‡∏¢‡∏≤</h2>
     </div>
     <div class="auth-tabs"><button class="auth-tab active" onclick="switchAuthTab('login')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button> <button class="auth-tab" onclick="switchAuthTab('register')">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
     </div>
     <form id="login-form" class="auth-form active">
      <div id="auth-error-message-login" class="auth-message hidden"></div>
      <div id="auth-success-message-login" class="auth-message hidden"></div>
      <div class="form-group"><label for="login-username">Username</label> <input type="text" id="login-username" required>
      </div>
      <div class="form-group"><label for="login-password">Password</label> <input type="password" id="login-password" required>
      </div><button type="submit" class="btn-primary">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
     </form>
     <form id="register-form" class="auth-form">
      <div id="auth-error-message-register" class="auth-message hidden"></div>
      <div id="auth-success-message-register" class="auth-message hidden"></div>
      <div class="form-row">
       <div class="form-group"><label for="register-prefix">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label> <select id="register-prefix" required> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option> <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option> <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option> <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option> </select>
       </div>
       <div class="form-group"><label for="register-firstname">‡∏ä‡∏∑‡πà‡∏≠</label> <input type="text" id="register-firstname" required>
       </div>
      </div>
      <div class="form-group"><label for="register-lastname">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label> <input type="text" id="register-lastname" required>
      </div>
      <div class="form-group"><label for="register-position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label> <input type="text" id="register-position" required>
      </div>
      <div class="form-group"><label for="register-department">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label> <input type="text" id="register-department" list="register-department-list" required> <datalist id="register-department-list"> <option value="‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î"></option> <option value="ÔøΩÔøΩ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ"></option> <option value="‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"></option> <option value="‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û"></option> <option value="‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå"></option> <option value="‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡∏ò‡∏≤‡∏•‡∏±‡∏™‡∏ã‡∏µ‡πÄ‡∏°‡∏µ‡∏¢"></option> <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢"></option> <option value="‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô"></option> <option value="‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°"></option> <option value="‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢"></option> <option value="‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û"></option> </datalist>
      </div>
      <div class="form-group"><label for="register-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</label> <input type="tel" id="register-phone" required>
      </div>
      <div class="form-group"><label for="register-username">Username</label> <input type="text" id="register-username" required>
      </div>
      <div class="form-group"><label for="register-password">Password</label> <input type="password" id="register-password" required>
      </div>
      <div class="form-group"><label for="register-confirm-password">Confirm Password</label> <input type="password" id="register-confirm-password" required>
      </div><button type="submit" class="btn-primary">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
     </form>
    </div>
   </div>
   <div class="header">
    <div class="header-content">
     <div class="header-left">
      <div class="logo"><img src="https://upload.wikimedia.org/wikipedia/th/d/d7/MED_Phayao.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏∞‡πÄ‡∏¢‡∏≤" onerror="this.style.display='none';">
      </div>
      <div class="header-text">
       <h1 id="system-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°<br>
        ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏∞‡πÄ‡∏¢‡∏≤</h1>
      </div>
     </div>
     <div class="header-right">
      <div class="user-info-badge">
       <div id="user-display-name">
        ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
       </div>
       <div id="user-role">
        ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£
       </div>
      </div><button id="logout-btn" class="logout-btn" onclick="handleLogout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
     </div>
    </div>
   </div>
   <div class="app-container">
    <div class="nav-menu"><button class="nav-btn active" onclick="showPage('calendar')">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</button> <button class="nav-btn" onclick="showPage('booking')">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</button> <button class="nav-btn" onclick="showPage('status')">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button> <button class="nav-btn" onclick="showPage('dashboard')">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</button> <button class="nav-btn hidden" id="admin-menu-btn" onclick="showPage('admin')">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
   </div>
   <div class="app-container">
    <div id="calendar-page" class="page">
     <div class="card">
      <h2 style="text-align: center;">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
      <div class="form-group"><label>‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label> <select id="room-filter"> <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á">‡∏´‡πâÔøΩÔøΩ‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option> </select>
      </div>
      <div class="legend">
       <div class="legend-item">
        <div class="legend-color" style="background: #7C3AED;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ</span>
       </div>
       <div class="legend-item">
        <div class="legend-color" style="background: #F97316;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á</span>
       </div>
       <div class="legend-item">
        <div class="legend-color" style="background: #10B981;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ</span>
       </div>
       <div class="legend-item">
        <div class="legend-color" style="background: #EF4444;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õÔøΩÔøΩÔøΩ‡∏∞‡∏ä‡∏∏‡∏° HA</span>
       </div>
       <div class="legend-item">
        <div class="legend-color" style="background: #EC4899;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏</span>
       </div>
       <div class="legend-item">
        <div class="legend-color" style="background: #06B6D4;"></div><span>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</span>
       </div>
      </div>
      <div class="calendar-container">
       <div class="calendar-controls"><button id="prev-month">‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button> <span class="calendar-month" id="calendar-month">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2024</span> <button id="next-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
       </div>
       <div class="calendar-header-days">
        <div>
         ‡∏≠‡∏≤
        </div>
        <div>
         ‡∏à
        </div>
        <div>
         ‡∏≠
        </div>
        <div>
         ‡∏û
        </div>
        <div>
         ‡∏û‡∏§
        </div>
        <div>
         ‡∏®
        </div>
        <div>
         ‡∏™
        </div>
       </div>
       <div class="calendar-grid" id="calendar-grid"></div>
      </div>
     </div>
    </div>
    <div id="booking-page" class="page hidden">
     <div class="card">
      <h2>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏áÔøΩÔøΩÔøΩ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
      <form id="booking-form">
       <div class="form-row">
        <div class="form-group"><label for="prefix">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ <span class="required">*</span></label> <select id="prefix" required> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option> <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option> <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option> <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option> </select>
        </div>
        <div class="form-group"><label for="fullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label> <input type="text" id="fullName" required>
        </div>
       </div>
       <div class="form-row">
        <div class="form-group"><label for="position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <span class="required">*</span></label> <input type="text" id="position" required>
        </div>
        <div class="form-group"><label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô <span class="required">*</span></label> <input type="text" id="department" list="department-list" required> <datalist id="department-list"> <option value="‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î"></option> <option value="‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ"></option> <option value="‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"></option> <option value="‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û"></option> <option value="‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå"></option> <option value="‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡∏ò‡∏≤‡∏•‡∏±‡∏™‡∏ã‡∏µ‡πÄ‡∏°‡∏µ‡∏¢"></option> <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢"></option> <option value="‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô"></option> <option value="‡πÅ‡∏û‡∏ó‡∏¢‡πå"></option> <option value="‡πÄ‡∏†‡∏™‡∏±ÔøΩÔøΩÔøΩ‡∏Å‡∏£‡∏£‡∏°"></option> <option value="‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢"></option> <option value="‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£"></option> <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û"></option> </datalist>
        </div>
       </div>
       <div class="form-group"><label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô <span class="required">*</span></label> <input type="tel" id="phone" required>
       </div>
       <div class="form-group"><label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span class="required">*</span></label> <select id="room" required> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ (60 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á (20 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ÑÔøΩÔøΩ‡∏ö‡∏î‡∏µ (14 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA (10 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏ (8 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (8 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á)</option> </select>
       </div>
       <div class="form-group"><label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏ß‡∏±‡∏ô / ‡∏õ‡∏µ ‡∏Ñ.‡∏®.) <span class="required">*</span></label> <input type="date" id="startDate" required>
       </div>
       <div class="form-row">
        <div class="form-group"><label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (AM ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏áÔøΩÔøΩ‡∏±‡∏ô / PM ‡∏Ñ‡∏∑‡∏≠ ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ß‡∏±‡∏ô) <span class="required">*</span></label> <input type="time" id="startTime" required>
        </div>
        <div class="form-group"><label>‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î (AM ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ß‡∏±‡∏ô / PM ‡∏Ñ‡∏∑‡∏≠ ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ß‡∏±‡∏ô) <span class="required">*</span></label> <input type="time" id="endTime" required>
        </div>
       </div>
       <div class="form-group"><label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span class="required">*</span></label> <textarea id="purpose" rows="3" required></textarea>
       </div>
       <div class="form-group">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;"><input type="checkbox" id="repeat-booking" style="width: auto; min-width: 20px; min-height: 20px; transform: scale(1.2); accent-color: #1976D2; cursor: pointer;"> <label for="repeat-booking" style="margin: 0; font-weight: 500; color: #1976D2; font-size: 14px; cursor: pointer;">‡∏à‡∏≠‡∏á‡∏ã‡πâ‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô (‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)</label>
        </div>
        <div id="repeat-dates-section" class="hidden" style="background: #F0F9FF; padding: 20px; border-radius: 12px; border: 2px solid #0EA5E9;">
         <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;"><label style="margin: 0; font-weight: 500; color: #0369A1; font-size: 14px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ã‡πâ‡∏≥:</label> <input type="date" id="additional-date" style="width: auto; min-width: 160px;"> <button type="button" id="add-date-btn" class="nav-btn" style="background: #10B981; color: white; padding: 8px 16px; font-size: 14px;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</button>
         </div>
         <div id="selected-dates-list" style="margin-top: 15px;"></div>
         <div style="background: #FEF3C7; padding: 12px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #F59E0B;">
          <p style="color: #92400E; font-size: 13px; margin: 0;"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ã‡πâ‡∏≥‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏ß‡∏•‡∏≤, ‡∏≠ÔøΩÔøΩ‡∏õ‡∏Å‡∏£‡∏ì‡πå, ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå) ‡πÅ‡∏•‡∏∞‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô</p>
         </div>
        </div>
       </div>
       <div class="form-group"><label>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
        <div class="equipment-section">
         <div class="equipment-category">
          <h4>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏∏‡∏î‡∏Å‡∏≤‡πÅ‡∏ü</h4>
          <div class="equipment-item"><input type="checkbox" id="coffee1"> <label for="coffee1">‡∏ä‡∏∏‡∏î‡∏Å‡∏≤‡πÅ‡∏ü ‡∏ï‡∏£‡∏≤ ‡∏®.‡∏£‡∏û.‡∏°‡∏û (‡∏ñ‡∏≤‡∏î‡∏£‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ß‡πÉ‡∏´‡∏ç‡πà)</label> <input type="number" id="coffee1-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="coffee2"> <label for="coffee2">‡∏ä‡∏∏‡∏î‡∏Å‡∏≤‡πÅ‡∏ü ‡∏ï‡∏£‡∏≤ ‡∏®.‡∏£‡∏û.‡∏°‡∏û (‡∏ñ‡∏≤‡∏î‡∏£‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ß‡πÄ‡∏•‡πá‡∏Å)</label> <input type="number" id="coffee2-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
         </div>
         <div class="equipment-category">
          <h4>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏°</h4>
          <div class="equipment-item"><input type="checkbox" id="glass1"> <label for="glass1">‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡∏°‡∏ä‡∏≤</label> <input type="number" id="glass1-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="glass2"> <label for="glass2">‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏°</label> <input type="number" id="glass2-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="glass3"> <label for="glass3">‡πÅ‡∏Å‡πâ‡∏ß soft drink</label> <input type="number" id="glass3-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
         </div>
         <div class="equipment-category">
          <h4>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h4>
          <div class="equipment-item"><input type="checkbox" id="equip1"> <label for="equip1">‡∏Å‡∏£‡∏∞‡∏ï‡∏¥‡∏Å‡∏ô‡πâ‡∏≥‡∏£‡πâ‡∏≠‡∏ô</label> <input type="number" id="equip1-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip2"> <label for="equip2">‡∏ñ‡∏≤‡∏î</label> <input type="number" id="equip2-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip3"> <label for="equip3">‡∏à‡∏≤‡∏ô‡∏£‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ß</label> <input type="number" id="equip3-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip4"> <label for="equip4">‡πÄ‡∏´‡∏¢‡∏∑‡∏≠‡∏Å‡∏ô‡πâ‡∏≥</label> <input type="number" id="equip4-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip5"> <label for="equip5">‡∏•‡∏±‡∏á‡πÉ‡∏™‡πà‡πÅ‡∏Å‡πâ‡∏ß</label> <input type="number" id="equip5-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip6"> <label for="equip6">‡∏Å‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏≤</label> <input type="number" id="equip6-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip7"> <label for="equip7">‡∏´‡∏°‡πâ‡∏≠‡∏ï‡πâ‡∏°‡∏ô‡πâ‡∏≥‡∏£‡πâ‡∏≠‡∏ô</label> <input type="number" id="equip7-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="equip8"> <label for="equip8">‡∏ïÔøΩÔøΩ‡∏Å‡∏£‡πâ‡∏≤</label> <input type="number" id="equip8-qty" min="0" max="60" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" disabled>
          </div>
          <div class="equipment-item"><input type="checkbox" id="other2"> <label for="other2">‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏</label> <input type="text" id="other2-desc" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" disabled>
          </div>
         </div>
        </div>
       </div>
       <div class="form-group" style="background: linear-gradient(145deg, #E3F2FD 0%, #BBDEFB 100%); padding: 24px; border-radius: 16px; border: 2px solid #1976D2; margin-bottom: 24px;">
        <div style="display: flex; align-items: center; gap: 24px; flex-wrap: wrap;">
         <div style="flex-shrink: 0;"><img src="https://qr-official.line.me/gs/M_027kjcez_BW.png?oat_content=qr" alt="LINE Official Account QR Code" style="width: 120px; height: 120px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); background: white; padding: 8px;" onerror="this.style.display='none';">
         </div>
         <div style="flex: 1; min-width: 250px;">
          <h4 style="color: #0D47A1; margin-bottom: 12px; font-size: 18px; font-weight: 600;">üì≤ ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE</h4>
          <p style="color: #1565C0; font-size: 15px; line-height: 1.6; margin: 0;">‡∏´‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ú‡πà‡∏≤‡∏ô LINE Official Account<br><strong>‡πÇ‡∏õ‡∏£‡∏î‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å</strong></p>
         </div>
        </div>
       </div><button type="submit" class="btn-primary">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</button>
      </form>
     </div>
    </div>
    <div id="status-page" class="page hidden">
     <div class="card">
      <h2>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>
      <div class="form-group"><label for="status-filter">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label> <select id="status-filter"> <option value="All">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option> <option value="‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option> <option value="‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option> <option value="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</option> <option value="‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥">‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option> </select>
      </div>
      <div id="status-list"></div>
      <div id="bookings-list"></div>
     </div>
    </div>
    <div id="dashboard-page" class="page hidden">
     <div class="card">
      <h2>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h2>
      <div id="dashboard-stats">
       <div class="stat-card">
        <div class="stat-value" id="total-bookings">
         0
        </div>
        <div class="stat-label">
         ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="approved-bookings">
         0
        </div>
        <div class="stat-label">
         ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="pending-bookings">
         0
        </div>
        <div class="stat-label">
         ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="today-bookings">
         0
        </div>
        <div class="stat-label">
         ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
        </div>
       </div>
      </div>
      <div class="chart-controls"><label for="year-select">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ:</label> <select id="year-select"> <option value="2024">2024</option> <option value="2025">2025</option> </select> <button class="chart-btn active" onclick="showChart('monthly')">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button> <button class="chart-btn" onclick="showChart('weekly')">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</button>
      </div>
      <div class="chart-container">
       <canvas id="usage-chart"></canvas>
      </div>
     </div>
    </div>
    <div id="admin-page" class="page hidden">
     <div class="card">
      <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ÔøΩÔøΩÔøΩ‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>
      <div id="admin-bookings-list"></div>
     </div>
     <div class="card">
      <h2>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
      <div id="users-list">
       <table class="user-table">
        <thead>
         <tr>
          <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
          <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
          <th>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td>user1</td>
          <td>‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</td>
          <td>‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥ÔøΩÔøΩÔøΩ‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</td>
          <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</td>
         </tr>
         <tr>
          <td>user2</td>
          <td>‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤ ‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</td>
          <td>‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</td>
          <td>‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</td>
         </tr>
        </tbody>
       </table>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 20px; border-radius: 12px; border: 2px solid #1976D2; margin: 30px auto; max-width: 1200px; text-align: center;">
   <p style="color: #0D47A1; font-size: 16px; font-weight: 500; margin: 0;">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 7043</p>
  </div>
  <div style="background: linear-gradient(135deg, #0D47A1 0%, #1976D2 100%); color: white; text-align: center; padding: 20px; margin-top: 40px;">
   <p style="margin: 0; font-size: 14px; font-weight: 500;">¬© University of Phayao Hospital</p>
  </div>
  <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwTcn22LhGVYFM2VbgtrRghfpuHMPrbCAQzrPzRUmHAmS5T5eep8PdOBxbKWLUdZ9Q/exec';

        const adminUsers = [
            {
                userId: 'ADMIN001',
                username: 'user1',
                password: 'pass001',
                prefix: '',
                firstName: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅÔøΩÔøΩ',
                lastName: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                position: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                department: '‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                phoneInternal: '7043',
                role: 'staff'
            },
            {
                userId: 'ADMIN002',
                username: 'user2',
                password: 'pass002',
                prefix: '',
                firstName: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤',
                lastName: '‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                position: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                department: '‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                phoneInternal: '7043',
                role: 'supervisor'
            }
        ];

        let currentUser = null;
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let allBookings = [];
        let bookings = [];
        let usageChart = null;
        let selectedAdditionalDates = [];
        let currentStatusPage = 1;
        let selectedChartYear = new Date().getFullYear();

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            
            const tabButton = Array.from(document.querySelectorAll('.auth-tab')).find(btn => 
                btn.getAttribute('onclick').includes(tab)
            );
            if (tabButton) tabButton.classList.add('active');
            
            const form = document.getElementById(`${tab}-form`);
            if (form) form.classList.add('active');
            
            clearAuthMessages();
        }

        function clearAuthMessages() {
            document.querySelectorAll('.auth-message').forEach(msg => msg.classList.add('hidden'));
        }

        function showAuthError(message, formType = 'login') {
            const errorDiv = document.getElementById(`auth-error-message-${formType}`);
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.classList.remove('hidden');
                errorDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            const successDiv = document.getElementById(`auth-success-message-${formType}`);
            if (successDiv) successDiv.classList.add('hidden');
        }

        function showAuthSuccess(message, formType = 'register') {
            const successDiv = document.getElementById(`auth-success-message-${formType}`);
            if (successDiv) {
                successDiv.textContent = message;
                successDiv.classList.remove('hidden');
                successDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            const errorDiv = document.getElementById(`auth-error-message-${formType}`);
            if (errorDiv) errorDiv.classList.add('hidden');
        }

        async function handleLogin(e) {
            e.preventDefault();
            clearAuthMessages();

            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;

            if (!username || !password) {
                showAuthError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', 'login');
                return;
            }

            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...';

            const adminUser = adminUsers.find(admin => 
                admin.username === username && admin.password === password
            );

            if (adminUser) {
                currentUser = adminUser;
                localStorage.setItem('authUser', JSON.stringify(currentUser));
                
                const role = currentUser.role || 'user';
                let displayName = `${currentUser.firstName} ${currentUser.lastName}`;
                
                document.getElementById('user-display-name').textContent = displayName;
                document.getElementById('user-role').textContent = role === 'supervisor' ? '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô' : role === 'staff' ? '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà' : currentUser.position || '‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£';

                const adminMenuBtn = document.getElementById('admin-menu-btn');
                if (role === 'staff' || role === 'supervisor') {
                    adminMenuBtn.classList.remove('hidden');
                } else {
                    adminMenuBtn.classList.add('hidden');
                }

                document.getElementById('auth-gate-overlay').style.display = 'none';
                
                setupEventListeners();
                await loadBookingsFromSheet(true);
                updateCalendar();
                updateStatusList();
                updateDashboard();
                updateAdminBookingsList();
                
                showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }

            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=login`);
                const data = await response.json();
                
                if (data.success && data.users) {
                    const foundUser = data.users.find(u => 
                        u.username === username && u.password === password
                    );
                    
                    if (foundUser) {
                        currentUser = foundUser;
                        localStorage.setItem('authUser', JSON.stringify(currentUser));
                        
                        const role = currentUser.role || 'user';
                        let displayName;
                        if (role === 'staff' || role === 'supervisor') {
                            displayName = `${currentUser.firstName} ${currentUser.lastName}`;
                        } else {
                            displayName = `${currentUser.prefix}${currentUser.firstName} ${currentUser.lastName}`;
                        }
                        
                        document.getElementById('user-display-name').textContent = displayName;
                        document.getElementById('user-role').textContent = role === 'supervisor' ? '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô' : role === 'staff' ? '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà' : currentUser.position || '‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£';

                        const adminMenuBtn = document.getElementById('admin-menu-btn');
                        if (role === 'staff' || role === 'supervisor') {
                            adminMenuBtn.classList.remove('hidden');
                        } else {
                            adminMenuBtn.classList.add('hidden');
                        }

                        document.getElementById('auth-gate-overlay').style.display = 'none';
                        
                        setupEventListeners();
                        await loadBookingsFromSheet(true);
                        updateCalendar();
                        updateStatusList();
                        updateDashboard();
                        updateAdminBookingsList();
                        prefillBookingForm();
                        
                        showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    } else {
                        showAuthError('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'login');
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                    }
                } else {
                    showAuthError('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'login');
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }
            } catch (error) {
                console.error('Login error:', error);
                showAuthError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏ÑÔøΩÔøΩÔøΩ‡∏±‡πâ‡∏á', 'login');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            clearAuthMessages();

            const prefix = document.getElementById('register-prefix').value;
            const firstName = document.getElementById('register-firstname').value.trim();
            const lastName = document.getElementById('register-lastname').value.trim();
            const position = document.getElementById('register-position').value.trim();
            const department = document.getElementById('register-department').value.trim();
            const phone = document.getElementById('register-phone').value.trim();
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;

            if (!prefix || !firstName || !lastName || !position || !department || !phone || !username || !password || !confirmPassword) {
                showAuthError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'register');
                return;
            }

            if (password !== confirmPassword) {
                showAuthError('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô', 'register');
                return;
            }

            if (password.length < 6) {
                showAuthError('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£', 'register');
                return;
            }

            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô...';

            try {
                const userData = {
                    userId: 'USER' + Date.now(),
                    username: username,
                    password: password,
                    prefix: prefix,
                    firstName: firstName,
                    lastName: lastName,
                    position: position,
                    department: department,
                    phoneInternal: phone,
                    role: 'user'
                };

                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify({
                        action: 'register',
                        user: userData
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showAuthSuccess('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö', 'register');
                    document.getElementById('register-form').reset();
                    
                    setTimeout(() => {
                        switchAuthTab('login');
                    }, 2000);
                } else {
                    showAuthError(result.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô', 'register');
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }
            } catch (error) {
                console.error('Register error:', error);
                showAuthError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'register');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        function handleLogout() {
            localStorage.removeItem('authUser');
            currentUser = null;
            document.getElementById('auth-gate-overlay').style.display = 'flex';
            showToast('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function checkAuthStatus() {
            const authUser = localStorage.getItem('authUser');
            if (authUser) {
                currentUser = JSON.parse(authUser);
                const role = currentUser.role || 'user';
                
                let displayName;
                if (role === 'staff' || role === 'supervisor') {
                    displayName = `${currentUser.firstName} ${currentUser.lastName}`;
                } else {
                    displayName = `${currentUser.prefix}${currentUser.firstName} ${currentUser.lastName}`;
                }
                
                document.getElementById('user-display-name').textContent = displayName;
                document.getElementById('user-role').textContent = role === 'supervisor' ? '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô' : role === 'staff' ? '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà' : currentUser.position || '‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£';

                const adminMenuBtn = document.getElementById('admin-menu-btn');
                if (role === 'staff' || role === 'supervisor') {
                    adminMenuBtn.classList.remove('hidden');
                } else {
                    adminMenuBtn.classList.add('hidden');
                }

                prefillBookingForm();
                
                document.getElementById('auth-gate-overlay').style.display = 'none';
                return true;
            }
            return false;
        }

        async function loadBookingsFromSheet(showLoadingToast = false) {
            if (showLoadingToast) {
                showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏à‡∏≤‡∏Å Google Sheet...', 'success');
            }
            
            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getBookings`);
                const data = await response.json();
                
                if (data.success) {
                    allBookings = data.bookings || [];
                    bookings = allBookings.filter(b => b.username === currentUser.username);
                    
                    if (showLoadingToast) {
                        showToast('‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'success');
                    }
                } else {
                    console.error('Error loading bookings:', data.error);
                    allBookings = [];
                    bookings = [];
                    if (showLoadingToast) {
                        showToast('‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'success');
                    }
                }
            } catch (error) {
                console.error('Error fetching bookings:', error);
                allBookings = [];
                bookings = [];
                if (showLoadingToast) {
                    showToast('‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'success');
                }
            }
        }

        function prefillBookingForm() {
            if (!currentUser) return;
            
            const role = currentUser.role || 'user';
            if (role === 'staff' || role === 'supervisor') return;
            
            document.getElementById('prefix').value = currentUser.prefix || '‡∏ô‡∏≤‡∏¢';
            document.getElementById('fullName').value = `${currentUser.firstName} ${currentUser.lastName}`;
            document.getElementById('position').value = currentUser.position || '';
            document.getElementById('department').value = currentUser.department || '';
            document.getElementById('phone').value = currentUser.phoneInternal || '';
        }

        function setupEventListeners() {
            document.getElementById('booking-form').addEventListener('submit', handleBookingSubmit);
            document.getElementById('prev-month').addEventListener('click', () => changeMonth(-1));
            document.getElementById('next-month').addEventListener('click', () => changeMonth(1));
            document.getElementById('room-filter').addEventListener('change', updateCalendar);
            document.getElementById('status-filter').addEventListener('change', () => {
                currentStatusPage = 1;
                updateStatusList();
            });

            document.querySelectorAll('.equipment-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const qtyInput = this.parentElement.querySelector('input[type="number"]');
                    const descInput = this.parentElement.querySelector('input[type="text"]');
                    
                    if (qtyInput) {
                        qtyInput.disabled = !this.checked;
                        if (!this.checked) qtyInput.value = '';
                    }
                    
                    if (descInput) {
                        descInput.disabled = !this.checked;
                        if (!this.checked) descInput.value = '';
                    }
                });
            });

            document.getElementById('repeat-booking').addEventListener('change', function() {
                const section = document.getElementById('repeat-dates-section');
                if (this.checked) {
                    section.classList.remove('hidden');
                } else {
                    section.classList.add('hidden');
                    selectedAdditionalDates = [];
                    updateSelectedDatesList();
                }
            });

            document.getElementById('add-date-btn').addEventListener('click', addAdditionalDate);

            document.getElementById('year-select').addEventListener('change', function() {
                selectedChartYear = parseInt(this.value);
                updateChart('monthly');
            });
        }

        function setupAuthEventListeners() {
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('register-form').addEventListener('submit', handleRegister);
        }

        async function initializeApp() {
            const isAuthenticated = checkAuthStatus();
            
            if (isAuthenticated) {
                setupEventListeners();
                await loadBookingsFromSheet(true);
                updateCalendar();
                updateStatusList();
                updateDashboard();
                updateAdminBookingsList();
            } else {
                setupAuthEventListeners();
            }
        }

        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            updateCalendar();
        }

        function updateCalendar() {
            const monthNames = [
                '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            
            document.getElementById('calendar-month').textContent = 
                `${monthNames[currentMonth]} ${currentYear + 543}`;

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';

            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                if (date.getMonth() !== currentMonth) {
                    dayElement.style.opacity = '0.3';
                }
                
                dayElement.innerHTML = `<div class="calendar-day-header">${date.getDate()}</div>`;
                
                const dayBookings = getBookingsForDate(date);
                dayBookings.forEach(booking => {
                    const event = document.createElement('div');
                    let roomClass = '';
                    if (booking.room.includes('‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á')) {
                        roomClass = 'room-‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á';
                    } else if (booking.room.includes('‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ')) {
                        roomClass = 'room-‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ';
                    } else if (booking.room.includes('HA')) {
                        roomClass = 'room-ha';
                    } else if (booking.room.includes('‡∏û‡∏±‡∏™‡∏î‡∏∏')) {
                        roomClass = 'room-‡∏û‡∏±‡∏™‡∏î‡∏∏';
                    } else if (booking.room.includes('‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')) {
                        roomClass = 'room-‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•';
                    } else {
                        roomClass = 'room-‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏©';
                    }
                    event.className = `calendar-event ${roomClass}`;
                    event.style.cursor = 'pointer';
                    event.title = `${booking.prefix}${booking.fullName} - ${booking.purpose}`;
                    
                    const timeDisplay = `${formatThaiTime(booking.startTime)}-${formatThaiTime(booking.endTime)}`;
                    const purposeDisplay = booking.purpose.length > 40 ? booking.purpose.substring(0, 40) + '...' : booking.purpose;
                    
                    event.innerHTML = `
                        <div style="font-weight: 600; margin-bottom: 3px; font-size: 11px; color: white;">${timeDisplay}</div>
                        <div style="font-size: 9px; opacity: 0.95; line-height: 1.3; color: white;">${purposeDisplay}</div>
                    `;
                    
                    event.onclick = (e) => {
                        e.stopPropagation();
                        showBookingDetails(booking);
                    };
                    
                    dayElement.appendChild(event);
                });
                
                grid.appendChild(dayElement);
            }
        }

        function getBookingsForDate(date) {
            const roomFilter = document.getElementById('room-filter').value;
            const localDate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000));
            const year = localDate.getFullYear();
            const month = String(localDate.getMonth() + 1).padStart(2, '0');
            const day = String(localDate.getDate()).padStart(2, '0');
            const dateStr = `${year}-${month}-${day}`;
            
            const filteredBookings = allBookings.filter(booking => {
                if (booking.status !== '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß') {
                    return false;
                }
                
                if (roomFilter && booking.room !== roomFilter) {
                    return false;
                }
                
                const bookingDate = normalizeDateString(booking.startDate);
                
                return bookingDate === dateStr;
            });
            
            return filteredBookings;
        }

        function normalizeDateString(dateStr) {
            if (!dateStr) return '';
            
            if (/^\d{4}-\d{2}-\d{2}$/.test(dateStr)) {
                return dateStr;
            }
            
            if (dateStr.includes('T')) {
                const date = new Date(dateStr);
                const localDate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000));
                const year = localDate.getFullYear();
                const month = String(localDate.getMonth() + 1).padStart(2, '0');
                const day = String(localDate.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            
            if (dateStr.includes('/')) {
                const parts = dateStr.split('/');
                if (parts.length === 3) {
                    const day = parts[0].padStart(2, '0');
                    const month = parts[1].padStart(2, '0');
                    let year = parts[2];
                    if (parseInt(year) > 2500) {
                        year = (parseInt(year) - 543).toString();
                    }
                    return `${year}-${month}-${day}`;
                }
            }
            
            return dateStr;
        }

        function formatThaiDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const day = String(date.getUTCDate()).padStart(2, '0');
            const month = String(date.getUTCMonth() + 1).padStart(2, '0');
            const year = date.getUTCFullYear() + 543;
            return `${day}/${month}/${year}`;
        }

        function formatThaiTime(timeStr) {
            if (!timeStr) return '00:00';
            if (timeStr.length === 5) return timeStr;
            return timeStr.padStart(5, '0');
        }

        function formatThaiDateTime(isoStr) {
            if (!isoStr) return '';
            const date = new Date(isoStr);
            const day = String(date.getUTCDate()).padStart(2, '0');
            const month = String(date.getUTCMonth() + 1).padStart(2, '0');
            const year = date.getUTCFullYear() + 543;
            const hours = String(date.getUTCHours()).padStart(2, '0');
            const minutes = String(date.getUTCMinutes()).padStart(2, '0');
            return `${day}/${month}/${year} ${hours}:${minutes}`;
        }

        function generateId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            return `BK${timestamp}${random}`;
        }

        function toThaiDateTime() {
            const now = new Date();
            const thaiTime = new Date(now.getTime() + (7 * 60 * 60 * 1000));
            return thaiTime.toISOString();
        }

        function collectEquipment() {
            const equipment = [];
            document.querySelectorAll('.equipment-item input[type="checkbox"]:checked').forEach(checkbox => {
                const label = checkbox.nextElementSibling.textContent;
                const qtyInput = checkbox.parentElement.querySelector('input[type="number"]');
                const descInput = checkbox.parentElement.querySelector('input[type="text"]');
                
                if (qtyInput && qtyInput.value) {
                    equipment.push(`${label}: ${qtyInput.value}`);
                } else if (descInput && descInput.value) {
                    equipment.push(`${label}: ${descInput.value}`);
                } else {
                    equipment.push(label);
                }
            });
            return equipment.join(', ');
        }

        function addAdditionalDate() {
            const dateInput = document.getElementById('additional-date');
            const selectedDate = dateInput.value;
            
            if (!selectedDate) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', 'error');
                return;
            }
            
            const mainDate = document.getElementById('startDate').value;
            if (selectedDate === mainDate) {
                showToast('‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß', 'error');
                return;
            }
            
            if (selectedAdditionalDates.includes(selectedDate)) {
                showToast('‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß', 'error');
                return;
            }
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const selectedDateObj = new Date(selectedDate);
            
            if (selectedDateObj < today) {
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ', 'error');
                return;
            }
            
            selectedAdditionalDates.push(selectedDate);
            dateInput.value = '';
            updateSelectedDatesList();
        }

        function updateSelectedDatesList() {
            const listEl = document.getElementById('selected-dates-list');
            
            if (selectedAdditionalDates.length === 0) {
                listEl.innerHTML = '<p style="color: #6B7280; font-size: 14px; text-align: center;">ÔøΩÔøΩ‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</p>';
                return;
            }
            
            listEl.innerHTML = selectedAdditionalDates.map((date, index) => `
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; background: white; border-radius: 8px; margin-bottom: 8px; border: 1px solid #E5E7EB;">
                    <span style="color: #1F2937; font-weight: 500;">${formatThaiDate(date)}</span>
                    <button type="button" onclick="removeAdditionalDate(${index})" style="background: #EF4444; color: white; border: none; border-radius: 6px; padding: 5px 12px; cursor: pointer; font-size: 12px; font-weight: 600;">‡∏•‡∏ö</button>
                </div>
            `).join('');
        }

        function removeAdditionalDate(index) {
            selectedAdditionalDates.splice(index, 1);
            updateSelectedDatesList();
        }

        function validateBooking(data) {
            if (!data.prefix || !data.fullName || !data.position || !data.department || 
                !data.phone || !data.room || !data.startDate || 
                !data.startTime || !data.endTime || !data.purpose) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ÑÔøΩÔøΩÔøΩ‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                return false;
            }

            const selectedDate = new Date(data.startDate);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (selectedDate < today) {
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≠‡∏á‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ', 'error');
                return false;
            }

            if (data.endTime <= data.startTime) {
                showToast('‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', 'error');
                return false;
            }

            return true;
        }

        function getConflictingBooking(newBooking) {
            return allBookings.find(booking => {
                if (booking.id === newBooking.id) {
                    return false;
                }

                if (booking.room !== newBooking.room || booking.status !== '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ïÔøΩÔøΩÔøΩ‡πÅ‡∏•‡πâ‡∏ß') {
                    return false;
                }

                const bookingDate = normalizeDateString(booking.startDate);
                const newBookingDate = normalizeDateString(newBooking.startDate);

                if (bookingDate !== newBookingDate) {
                    return false;
                }

                const newStartTime = formatTimeForDisplay(newBooking.startTime);
                const newEndTime = formatTimeForDisplay(newBooking.endTime);
                const existingStartTime = formatTimeForDisplay(booking.startTime);
                const existingEndTime = formatTimeForDisplay(booking.endTime);

                const newStart = new Date(`${newBookingDate}T${newStartTime}`);
                const newEnd = new Date(`${newBookingDate}T${newEndTime}`);
                const existingStart = new Date(`${bookingDate}T${existingStartTime}`);
                const existingEnd = new Date(`${bookingDate}T${existingEndTime}`);

                return (newStart < existingEnd && newEnd > existingStart);
            });
        }

        function formatTimeForDisplay(time) {
            if (!time) return '00:00';
            if (time.length === 5) return time;
            if (time.includes(':')) return time;
            return time.padStart(5, '0');
        }

        async function saveBookingToSheet(bookingData) {
            try {
                const sheetData = {
                    ...bookingData,
                    startTime: bookingData.startTime,
                    endTime: bookingData.endTime,
                    startDate: bookingData.startDate,
                    endDate: bookingData.endDate,
                    createdAt: bookingData.createdAt,
                    approvedAt: bookingData.approvedAt
                };

                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify({
                        action: 'saveBooking',
                        booking: sheetData
                    })
                });
                
                const result = await response.json();
                return result.success;
            } catch (error) {
                console.error('Error saving booking:', error);
                return false;
            }
        }

        async function deleteBookingFromSheet(bookingId) {
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify({
                        action: 'deleteBooking',
                        bookingId: bookingId
                    })
                });
                
                const result = await response.json();
                return result.success;
            } catch (error) {
                console.error('Error deleting booking:', error);
                return false;
            }
        }

        async function handleBookingSubmit(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠...';
            
            const bookingData = {
                id: generateId(),
                prefix: document.getElementById('prefix').value,
                fullName: document.getElementById('fullName').value,
                position: document.getElementById('position').value,
                department: document.getElementById('department').value,
                phone: document.getElementById('phone').value,
                room: document.getElementById('room').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('startDate').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                purpose: document.getElementById('purpose').value,
                equipment: collectEquipment(),
                status: '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö',
                approver: '',
                createdAt: toThaiDateTime(),
                approvedAt: null,
                username: currentUser.username
            };

            if (!validateBooking(bookingData)) {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }

            const conflictBooking = getConflictingBooking(bookingData);
            if (conflictBooking) {
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ôÔøΩÔøΩ‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÅ‡∏•‡πâ‡∏ß', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }

            const allBookingsToCreate = [bookingData];
            let conflictFound = false;
            
            if (document.getElementById('repeat-booking').checked && selectedAdditionalDates.length > 0) {
                for (const additionalDate of selectedAdditionalDates) {
                    const additionalBooking = {
                        ...bookingData,
                        id: generateId(),
                        startDate: additionalDate,
                        endDate: additionalDate,
                        createdAt: toThaiDateTime()
                    };
                    
                    const additionalConflict = getConflictingBooking(additionalBooking);
                    if (additionalConflict) {
                        showToast('‡πÑ‡∏°‡πà‡∏™ÔøΩÔøΩÔøΩ‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÅ‡∏•‡πâ‡∏ß', 'error');
                        conflictFound = true;
                        break;
                    }
                    
                    allBookingsToCreate.push(additionalBooking);
                }
            }
            
            if (conflictFound) {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }

            let successCount = 0;
            const bookingIds = [];
            
            for (const booking of allBookingsToCreate) {
                const saved = await saveBookingToSheet(booking);
                if (saved) {
                    bookings.push(booking);
                    allBookings.push(booking);
                    bookingIds.push(booking.id);
                    successCount++;
                } else {
                    bookings.push(booking);
                    allBookings.push(booking);
                    bookingIds.push(booking.id);
                    successCount++;
                }
            }

            if (successCount > 0) {
                if (successCount === 1) {
                    showToast(`‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á: ${bookingIds[0]}`, 'success');
                } else {
                    showToast(`‡∏™‡πà‡∏áÔøΩÔøΩÔøΩ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${successCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á: ${bookingIds.join(', ')}`, 'success');
                }
                
                document.getElementById('booking-form').reset();
                document.getElementById('repeat-booking').checked = false;
                document.getElementById('repeat-dates-section').classList.add('hidden');
                selectedAdditionalDates = [];
                updateSelectedDatesList();
                
                prefillBookingForm();
                
                updateStatusList();
                updateCalendar();
                updateAdminBookingsList();
                updateDashboard();
                
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                
                showPage('status');
            } else {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        function getStatusClass(status) {
            const statusClasses = {
                '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö': 'status-pending',
                '‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ': 'status-head',
                '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß': 'status-approved',
                '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': 'status-rejected'
            };
            return statusClasses[status] || 'status-pending';
        }

        function updateStatusList() {
            const filter = document.getElementById('status-filter').value;
            const searchTerm = document.getElementById('search-input') ? document.getElementById('search-input').value.toLowerCase() : '';
            const list = document.getElementById('bookings-list');
            
            const isAdmin = currentUser && (currentUser.role === 'staff' || currentUser.role === 'supervisor');
            
            let filteredBookings = isAdmin ? allBookings : bookings;
            
            if (searchTerm) {
                filteredBookings = filteredBookings.filter(b => 
                    b.id.toLowerCase().includes(searchTerm) ||
                    b.fullName.toLowerCase().includes(searchTerm) ||
                    b.department.toLowerCase().includes(searchTerm) ||
                    b.room.toLowerCase().includes(searchTerm) ||
                    (b.prefix + b.fullName).toLowerCase().includes(searchTerm)
                );
            }
            
            if (filter && filter !== 'All') {
                filteredBookings = filteredBookings.filter(b => b.status === filter);
            }
            
            filteredBookings.sort((a, b) => {
                const dateA = new Date(a.createdAt || 0);
                const dateB = new Date(b.createdAt || 0);
                return dateB - dateA;
            });
            
            const itemsPerPage = 10;
            const totalPages = Math.ceil(filteredBookings.length / itemsPerPage);
            const startIndex = (currentStatusPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedBookings = filteredBookings.slice(startIndex, endIndex);
            
            list.innerHTML = '';
            
            if (filteredBookings.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #6B7280;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</div>';
                return;
            }
            
            const paginationInfo = document.createElement('div');
            paginationInfo.style.cssText = 'text-align: center; margin-bottom: 20px; padding: 15px; background: #F0F9FF; border-radius: 10px; color: #0369A1; font-weight: 500;';
            paginationInfo.innerHTML = `‡πÅ‡∏™‡∏î‡∏á ${startIndex + 1}-${Math.min(endIndex, filteredBookings.length)} ‡∏à‡∏≤‡∏Å ${filteredBookings.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏´‡∏ô‡πâ‡∏≤ ${currentStatusPage}/${totalPages})`;
            list.appendChild(paginationInfo);
            
            paginatedBookings.forEach(booking => {
                const item = document.createElement('div');
                item.className = 'status-item';
                
                const statusClass = getStatusClass(booking.status);
                
                const isAdmin = currentUser && (currentUser.role === 'staff' || currentUser.role === 'supervisor');
                const isOwnBooking = booking.username === currentUser.username;
                
                let actionButtons = `<button class="btn-small btn-info" onclick='showBookingDetails(${JSON.stringify(booking).replace(/'/g, "&#39;")})'>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>`;
                
                if (isAdmin) {
                    actionButtons += `
                        <button class="btn-small btn-warning" onclick='showEditBookingModal(${JSON.stringify(booking).replace(/'/g, "&#39;")})'>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button class="btn-small btn-danger" onclick='deleteBooking("${booking.id}")'>‡∏•‡∏ö</button>
                    `;
                } else if (isOwnBooking) {
                    actionButtons += `
                        <button class="btn-small btn-warning" onclick='showEditBookingModal(${JSON.stringify(booking).replace(/'/g, "&#39;")})'>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                    `;
                }
                
                item.innerHTML = `
                    <div class="status-badge ${statusClass}">${booking.status}</div>
                    <h4>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á: ${booking.id}</h4>
                    <p><strong>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</strong> ${booking.prefix}${booking.fullName}</p>
                    <p><strong>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°:</strong> ${booking.room}</p>
                    <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${formatThaiDate(booking.startDate)} - ${formatThaiDate(booking.endDate)}</p>
                    <p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${formatThaiTime(booking.startTime)} - ${formatThaiTime(booking.endTime)}</p>
                    <p><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> ${booking.purpose}</p>
                    ${booking.equipment ? `<p><strong>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${booking.equipment}</p>` : ''}
                    ${booking.status === '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' && booking.approver ? 
                        `<p><strong>‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong> ${booking.approver}</p>` : ''}
                    ${booking.status === '‡∏≠ÔøΩÔøΩÔøΩ‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' && booking.approver ? 
                        `<p><strong>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong> ${booking.approver}</p>` : ''}
                    ${booking.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' && booking.approvedAt ? 
                        `<p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong> ${formatThaiDateTime(booking.approvedAt)}</p>` : ''}
                    <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                        ${actionButtons}
                    </div>
                `;
                
                list.appendChild(item);
            });
            
            if (totalPages > 1) {
                const paginationControls = document.createElement('div');
                paginationControls.style.cssText = 'display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 30px; flex-wrap: wrap;';
                
                const prevBtn = document.createElement('button');
                prevBtn.className = 'nav-btn';
                prevBtn.textContent = '‚Äπ ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤';
                prevBtn.disabled = currentStatusPage === 1;
                prevBtn.onclick = () => {
                    if (currentStatusPage > 1) {
                        currentStatusPage--;
                        updateStatusList();
                        document.getElementById('status-list').scrollIntoView({ behavior: 'smooth' });
                    }
                };
                if (prevBtn.disabled) {
                    prevBtn.style.opacity = '0.5';
                    prevBtn.style.cursor = 'not-allowed';
                }
                paginationControls.appendChild(prevBtn);
                
                const maxVisiblePages = 5;
                let startPage = Math.max(1, currentStatusPage - Math.floor(maxVisiblePages / 2));
                let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
                
                if (endPage - startPage < maxVisiblePages - 1) {
                    startPage = Math.max(1, endPage - maxVisiblePages + 1);
                }
                
                if (startPage > 1) {
                    const firstPageBtn = document.createElement('button');
                    firstPageBtn.className = 'nav-btn';
                    firstPageBtn.textContent = '1';
                    firstPageBtn.onclick = () => {
                        currentStatusPage = 1;
                        updateStatusList();
                        document.getElementById('status-list').scrollIntoView({ behavior: 'smooth' });
                    };
                    paginationControls.appendChild(firstPageBtn);
                    
                    if (startPage > 2) {
                        const dots = document.createElement('span');
                        dots.textContent = '...';
                        dots.style.padding = '0 10px';
                        paginationControls.appendChild(dots);
                    }
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = 'nav-btn';
                    pageBtn.textContent = i;
                    if (i === currentStatusPage) {
                        pageBtn.classList.add('active');
                    }
                    pageBtn.onclick = () => {
                        currentStatusPage = i;
                        updateStatusList();
                        document.getElementById('status-list').scrollIntoView({ behavior: 'smooth' });
                    };
                    paginationControls.appendChild(pageBtn);
                }
                
                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        const dots = document.createElement('span');
                        dots.textContent = '...';
                        dots.style.padding = '0 10px';
                        paginationControls.appendChild(dots);
                    }
                    
                    const lastPageBtn = document.createElement('button');
                    lastPageBtn.className = 'nav-btn';
                    lastPageBtn.textContent = totalPages;
                    lastPageBtn.onclick = () => {
                        currentStatusPage = totalPages;
                        updateStatusList();
                        document.getElementById('status-list').scrollIntoView({ behavior: 'smooth' });
                    };
                    paginationControls.appendChild(lastPageBtn);
                }
                
                const nextBtn = document.createElement('button');
                nextBtn.className = 'nav-btn';
                nextBtn.textContent = '‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Ä∫';
                nextBtn.disabled = currentStatusPage === totalPages;
                nextBtn.onclick = () => {
                    if (currentStatusPage < totalPages) {
                        currentStatusPage++;
                        updateStatusList();
                        document.getElementById('status-list').scrollIntoView({ behavior: 'smooth' });
                    }
                };
                if (nextBtn.disabled) {
                    nextBtn.style.opacity = '0.5';
                    nextBtn.style.cursor = 'not-allowed';
                }
                paginationControls.appendChild(nextBtn);
                
                list.appendChild(paginationControls);
            }
        }

        async function approveBooking(bookingId, approverRole) {
            if (!bookingId) return;
            
            const booking = allBookings.find(b => b.id === bookingId);
            if (!booking) {
                showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á', 'error');
                return;
            }
            
            const approverName = `${currentUser.firstName} ${currentUser.lastName}`;
            
            if (approverRole === 'staff' && booking.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö') {
                booking.status = '‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
                booking.approver = approverName;
            } else if (approverRole === 'supervisor' && booking.status === '‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ') {
                booking.status = '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß';
                booking.approver = approverName;
                booking.approvedAt = toThaiDateTime();
            } else {
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ', 'error');
                return;
            }
            
            const success = await saveBookingToSheet(booking);
            
            if (success) {
                const index = allBookings.findIndex(b => b.id === bookingId);
                if (index !== -1) {
                    allBookings[index] = booking;
                }
                
                const userIndex = bookings.findIndex(b => b.id === bookingId);
                if (userIndex !== -1) {
                    bookings[userIndex] = booking;
                }
                
                updateAdminBookingsList();
                updateStatusList();
                updateCalendar();
                updateDashboard();
                
                showToast('‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'error');
            }
        }

        async function rejectBooking(bookingId, approverRole) {
            if (!bookingId) return;
            
            const reason = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:');
            if (!reason || reason.trim() === '') {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'error');
                return;
            }
            
            const booking = allBookings.find(b => b.id === bookingId);
            if (!booking) {
                showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á', 'error');
                return;
            }
            
            const approverName = `${currentUser.firstName} ${currentUser.lastName}`;
            
            booking.status = '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥';
            booking.approver = approverName;
            booking.rejectionReason = reason.trim();
            
            const success = await saveBookingToSheet(booking);
            
            if (success) {
                const index = allBookings.findIndex(b => b.id === bookingId);
                if (index !== -1) {
                    allBookings[index] = booking;
                }
                
                const userIndex = bookings.findIndex(b => b.id === bookingId);
                if (userIndex !== -1) {
                    bookings[userIndex] = booking;
                }
                
                updateAdminBookingsList();
                updateStatusList();
                updateCalendar();
                updateDashboard();
                
                showToast('‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'error');
            }
        }

        async function deleteBooking(bookingId) {
            if (!bookingId) return;
            
            const confirmed = confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ');
            if (!confirmed) return;
            
            showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•ÔøΩÔøΩÔøΩ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', 'success');
            
            const success = await deleteBookingFromSheet(bookingId);
            
            if (success) {
                allBookings = allBookings.filter(b => b.id !== bookingId);
                bookings = bookings.filter(b => b.id !== bookingId);
                
                updateStatusList();
                updateCalendar();
                updateAdminBookingsList();
                updateDashboard();
                
                showToast('‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            }
        }

        function showEditBookingModal(booking) {
            if (!booking) return;
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á - ${booking.id}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 32px;">
                        <form id="edit-booking-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                                    <select id="edit-prefix" required>
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option>
                                        <option value="‡∏ô‡∏≤‡∏¢" ${booking.prefix === '‡∏ô‡∏≤‡∏¢' ? 'selected' : ''}>‡∏ô‡∏≤‡∏¢</option>
                                        <option value="‡∏ô‡∏≤‡∏á" ${booking.prefix === '‡∏ô‡∏≤‡∏á' ? 'selected' : ''}>‡∏ô‡∏≤‡∏á</option>
                                        <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß" ${booking.prefix === '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß' ? 'selected' : ''}>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                    <input type="text" id="edit-fullName" value="${booking.fullName}" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                    <input type="text" id="edit-position" value="${booking.position}" required>
                                </div>
                                <div class="form-group">
                                    <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                                    <input type="text" id="edit-department" value="${booking.department}" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®ÔøΩÔøΩÔøΩ‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</label>
                                <input type="tel" id="edit-phone" value="${booking.phone}" required>
                            </div>
                            
                            <div class="form-group">
                                <label>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label>
                                <select id="edit-room" required>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£ÔøΩÔøΩ</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂ÔøΩÔøΩ‡∏á' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏</option>
                                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•" ${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•' ? 'selected' : ''}>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</label>
                                <input type="date" id="edit-startDate" value="${booking.startDate}" required onclick="this.showPicker && this.showPicker()">
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                                    <input type="time" id="edit-startTime" value="${booking.startTime}" required onclick="this.showPicker && this.showPicker()">
                                </div>
                                <div class="form-group">
                                    <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                                    <input type="time" id="edit-endTime" value="${booking.endTime}" required onclick="this.showPicker && this.showPicker()">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label>
                                <textarea id="edit-purpose" rows="3" required>${booking.purpose}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</label>
                                <textarea id="edit-equipment" rows="2">${booking.equipment || ''}</textarea>
                            </div>
                            
                            <div style="display: flex; gap: 12px; margin-top: 30px;">
                                <button type="submit" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                <button type="button" class="nav-btn" onclick="this.closest('.modal').remove()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            document.getElementById('edit-booking-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const updatedBooking = {
                    ...booking,
                    prefix: document.getElementById('edit-prefix').value,
                    fullName: document.getElementById('edit-fullName').value,
                    position: document.getElementById('edit-position').value,
                    department: document.getElementById('edit-department').value,
                    phone: document.getElementById('edit-phone').value,
                    room: document.getElementById('edit-room').value,
                    startDate: document.getElementById('edit-startDate').value,
                    endDate: document.getElementById('edit-startDate').value,
                    startTime: document.getElementById('edit-startTime').value,
                    endTime: document.getElementById('edit-endTime').value,
                    purpose: document.getElementById('edit-purpose').value,
                    equipment: document.getElementById('edit-equipment').value
                };
                
                if (!validateBooking(updatedBooking)) {
                    return;
                }
                
                const conflictBooking = getConflictingBooking(updatedBooking);
                if (conflictBooking) {
                    showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ßÔøΩÔøΩ‡∏•‡πâ‡∏ß', 'error');
                    return;
                }
                
                const success = await saveBookingToSheet(updatedBooking);
                
                if (success) {
                    const index = allBookings.findIndex(b => b.id === booking.id);
                    if (index !== -1) {
                        allBookings[index] = updatedBooking;
                    }
                    
                    const userIndex = bookings.findIndex(b => b.id === booking.id);
                    if (userIndex !== -1) {
                        bookings[userIndex] = updatedBooking;
                    }
                    
                    updateStatusList();
                    updateCalendar();
                    updateAdminBookingsList();
                    updateDashboard();
                    
                    modal.remove();
                    showToast('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                }
            });
        }

        function showBookingDetails(booking) {
            if (!booking) return;
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á - ${booking.id}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 32px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div>
                                <p style="margin-bottom: 12px;"><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á:</strong><br>${booking.id}</p>
                                <p style="margin-bottom: 12px;"><strong>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</strong><br>${booking.prefix}${booking.fullName}</p>
                                <p style="margin-bottom: 12px;"><strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong><br>${booking.position}</p>
                                <p style="margin-bottom: 12px;"><strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô:</strong><br>${booking.department}</p>
                                <p style="margin-bottom: 12px;"><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong><br>${booking.phone}</p>
                            </div>
                            <div>
                                <p style="margin-bottom: 12px;"><strong>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°:</strong><br>${booking.room}</p>
                                <p style="margin-bottom: 12px;"><strong>ÔøΩÔøΩ‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong><br>${formatThaiDate(booking.startDate)}</p>
                                <p style="margin-bottom: 12px;"><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong><br>${formatThaiTime(booking.startTime)} - ${formatThaiTime(booking.endTime)}</p>
                                <p style="margin-bottom: 12px;"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong><br><span class="status-badge ${getStatusClass(booking.status)}">${booking.status}</span></p>
                                ${booking.approver ? `<p style="margin-bottom: 12px;"><strong>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong><br>${booking.approver}</p>` : ''}
                                ${booking.approvedAt ? `<p style="margin-bottom: 12px;"><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong><br>${formatThaiDateTime(booking.approvedAt)}</p>` : ''}
                            </div>
                        </div>
                        
                        <div style="border-top: 1px solid #E5E7EB; padding-top: 20px; margin-bottom: 20px;">
                            <p style="margin-bottom: 12px;"><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á:</strong></p>
                            <div style="background: #F9FAFB; padding: 16px; border-radius: 8px; border-left: 4px solid #1976D2;">
                                ${booking.purpose}
                            </div>
                        </div>
                        
                        ${booking.equipment ? `
                        <div style="border-top: 1px solid #E5E7EB; padding-top: 20px; margin-bottom: 20px;">
                            <p style="margin-bottom: 12px;"><strong>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ:</strong></p>
                            <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; border-left: 4px solid #0EA5E9;">
                                ${booking.equipment}
                            </div>
                        </div>
                        ` : ''}
                        
                        <div style="text-align: right; margin-top: 30px;">
                            <button class="nav-btn" onclick="this.closest('.modal').remove()">‡∏õ‡∏¥‡∏î</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(`${page}-page`).classList.remove('hidden');
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            if (page === 'calendar' || page === 'status' || page === 'dashboard' || page === 'admin') {
                await loadBookingsFromSheet(false);
            }
            
            if (page === 'calendar') {
                updateCalendar();
            } else if (page === 'status') {
                currentStatusPage = 1;
                updateStatusList();
            } else if (page === 'dashboard') {
                updateDashboard();
            } else if (page === 'admin') {
                updateAdminBookingsList();
            }
        }

        function updateDashboard() {
            updateDashboardStats();
            if (!usageChart) {
                initChart();
            }
            populateYearSelector();
            updateChart('monthly');
        }

        function updateDashboardStats() {
            const today = new Date().toISOString().split('T')[0];
            const totalBookings = allBookings.length;
            const approvedBookings = allBookings.filter(b => b.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß').length;
            const pendingBookings = allBookings.filter(b => b.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' || b.status === '‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ').length;
            const todayBookings = allBookings.filter(b => normalizeDateString(b.startDate) === today && b.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß').length;

            const statsContainer = document.getElementById('dashboard-stats');
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalBookings}</div>
                    <div class="stat-label">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${approvedBookings}</div>
                    <div class="stat-label">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${pendingBookings}</div>
                    <div class="stat-label">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${todayBookings}</div>
                    <div class="stat-label">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">6</div>
                    <div class="stat-label">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
            `;
        }

        function populateYearSelector() {
            const yearSelect = document.getElementById('year-select');
            const currentYear = new Date().getFullYear();
            const years = [];
            
            allBookings.forEach(booking => {
                if (booking.startDate) {
                    const date = new Date(normalizeDateString(booking.startDate));
                    const year = date.getFullYear();
                    if (!years.includes(year)) {
                        years.push(year);
                    }
                }
            });
            
            years.sort((a, b) => b - a);
            
            if (years.length === 0) {
                years.push(currentYear);
            }
            
            yearSelect.innerHTML = years.map(year => 
                `<option value="${year}">${year + 543}</option>`
            ).join('');
        }

        function initChart() {
            const ctx = document.getElementById('usage-chart').getContext('2d');
            usageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏î‡∏£.‡∏°‡∏ì‡∏ë‡∏• ‡∏™‡∏á‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏®‡∏£‡∏µ',
                        data: [],
                        backgroundColor: '#7C3AED'
                    }, {
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á',
                        data: [],
                        backgroundColor: '#F97316'
                    }, {
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ',
                        data: [],
                        backgroundColor: '#10B981'
                    }, {
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HA',
                        data: [],
                        backgroundColor: '#EF4444'
                    }, {
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏',
                        data: [],
                        backgroundColor: '#EC4899'
                    }, {
                        label: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
                        data: [],
                        backgroundColor: '#06B6D4'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function showChart(type) {
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateChart(type);
        }

        function updateChart(type) {
            if (!usageChart) return;
            
            const approvedBookings = allBookings.filter(b => b.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß');
            
            if (type === 'weekly') {
                const weekData = getWeeklyData(approvedBookings);
                usageChart.data.labels = weekData.labels;
                usageChart.data.datasets[0].data = weekData.mondol;
                usageChart.data.datasets[1].data = weekData.rungpheung;
                usageChart.data.datasets[2].data = weekData.dean;
                usageChart.data.datasets[3].data = weekData.ha;
                usageChart.data.datasets[4].data = weekData.supply;
                usageChart.data.datasets[5].data = weekData.nursing;
            } else {
                const monthData = getMonthlyData(approvedBookings);
                usageChart.data.labels = monthData.labels;
                usageChart.data.datasets[0].data = monthData.mondol;
                usageChart.data.datasets[1].data = monthData.rungpheung;
                usageChart.data.datasets[2].data = monthData.dean;
                usageChart.data.datasets[3].data = monthData.ha;
                usageChart.data.datasets[4].data = monthData.supply;
                usageChart.data.datasets[5].data = monthData.nursing;
            }
            
            usageChart.update();
        }

        function getWeeklyData(bookings) {
            const days = ['‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏∏‡∏ò', '‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ', '‡∏®‡∏∏‡∏Å‡∏£‡πå', '‡πÄ‡∏™‡∏≤‡∏£‡πå'];
            const mondol = new Array(7).fill(0);
            const rungpheung = new Array(7).fill(0);
            const dean = new Array(7).fill(0);
            const ha = new Array(7).fill(0);
            const supply = new Array(7).fill(0);
            const nursing = new Array(7).fill(0);
            
            const now = new Date();
            const currentDayOfWeek = now.getDay();
            const weekStart = new Date(now);
            weekStart.setDate(now.getDate() - currentDayOfWeek);
            weekStart.setHours(0, 0, 0, 0);
            
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6);
            weekEnd.setHours(23, 59, 59, 999);
            
            bookings.forEach(booking => {
                if (booking.startDate) {
                    const date = new Date(normalizeDateString(booking.startDate));
                    
                    if (date >= weekStart && date <= weekEnd) {
                        const dayIndex = date.getDay();
                        
                        if (booking.room.includes('‡∏°‡∏ì‡∏ë‡∏•')) {
                            mondol[dayIndex]++;
                        } else if (booking.room.includes('‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á')) {
                            rungpheung[dayIndex]++;
                        } else if (booking.room.includes('‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ')) {
                            dean[dayIndex]++;
                        } else if (booking.room.includes('HA')) {
                            ha[dayIndex]++;
                        } else if (booking.room.includes('‡∏û‡∏±‡∏™‡∏î‡∏∏')) {
                            supply[dayIndex]++;
                        } else if (booking.room.includes('‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')) {
                            nursing[dayIndex]++;
                        }
                    }
                }
            });
            
            return { labels: days, mondol, rungpheung, dean, ha, supply, nursing };
        }

        function getMonthlyData(bookings) {
            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            const mondol = new Array(12).fill(0);
            const rungpheung = new Array(12).fill(0);
            const dean = new Array(12).fill(0);
            const ha = new Array(12).fill(0);
            const supply = new Array(12).fill(0);
            const nursing = new Array(12).fill(0);
            
            bookings.forEach(booking => {
                if (booking.startDate) {
                    const date = new Date(normalizeDateString(booking.startDate));
                    const bookingYear = date.getFullYear();
                    
                    if (bookingYear === selectedChartYear) {
                        const monthIndex = date.getMonth();
                        
                        if (booking.room.includes('‡∏°‡∏ì‡∏ë‡∏•')) {
                            mondol[monthIndex]++;
                        } else if (booking.room.includes('‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á')) {
                            rungpheung[monthIndex]++;
                        } else if (booking.room.includes('‡∏Ñ‡∏ì‡∏ö‡∏î‡∏µ')) {
                            dean[monthIndex]++;
                        } else if (booking.room.includes('HA')) {
                            ha[monthIndex]++;
                        } else if (booking.room.includes('‡∏û‡∏±‡∏™‡∏î‡∏∏')) {
                            supply[monthIndex]++;
                        } else if (booking.room.includes('‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')) {
                            nursing[monthIndex]++;
                        }
                    }
                }
            });
            
            return { labels: months, mondol, rungpheung, dean, ha, supply, nursing };
        }

        function updateAdminBookingsList() {
            if (!currentUser || (currentUser.role !== 'staff' && currentUser.role !== 'supervisor')) return;

            const listEl = document.getElementById('admin-bookings-list');

            if (allBookings.length === 0) {
                listEl.innerHTML = '<div style="text-align:center;color:#6B7280;padding:40px 0;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢ÔøΩÔøΩ‡∏≤‡∏£‡∏à‡∏≠‡∏á</div>';
                return;
            }

            listEl.innerHTML = allBookings.map(booking => {
                const statusClass = getStatusClass(booking.status);
                
                let actionButtons = '';
                if (booking.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö') {
                    actionButtons = `
                        <button onclick="showBookingDetails(${JSON.stringify(booking).replace(/"/g, '&quot;')})" class="btn-small btn-info">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                    `;
                } else if (booking.status === '‡∏£‡∏≠‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ' && currentUser.role === 'supervisor') {
                    actionButtons = `
                        <button onclick="showBookingDetails(${JSON.stringify(booking).replace(/"/g, '&quot;')})" class="btn-small btn-info">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                    `;
                } else {
                    actionButtons = `<button onclick="showBookingDetails(${JSON.stringify(booking).replace(/"/g, '&quot;')})" class="btn-small btn-info">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>`;
                }
                
                return `
                    <div class="status-item">
                        <div class="status-header">
                            <div>
                                <h3 style="margin:0 0 4px 0;color:#0D47A1;font-size:18px;">${booking.room}</h3>
                                <p style="margin:0;color:#6B7280;font-size:14px;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${booking.id} - ${booking.fullName} (${booking.username})</p>
                            </div>
                            <span class="status-badge ${statusClass}">${booking.status}</span>
                        </div>
                        <div class="status-info">
                            <div>üìÖ ${booking.startDate}</div>
                            <div>üïê ${formatThaiTime(booking.startTime)} - ${formatThaiTime(booking.endTime)}</div>
                            <div style="grid-column:1/-1;">üìã ${booking.purpose}</div>
                        </div>
                        <div class="admin-actions">
                            ${actionButtons}
                        </div>
                    </div>
                `;
            }).join('');
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ba3f21f9094a1b7',t:'MTc2Nzc5NDA1My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>